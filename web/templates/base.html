<!DOCTYPE html>
<html lang="{{ lang | default(value='en') }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- TODO: Remove this meta tag when ready for public launch -->
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <meta name="description" content="{% block description %}A bio-acoustic instrument for generative composition{% endblock description %}">
    <meta name="theme-color" content="#000000">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ get_url(path='favicon.ico') }}">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ get_url(path='main.css') }}">

    <!-- Open Graph -->
    <meta property="og:title" content="{% block og_title %}{{ config.title }}{% endblock og_title %}">
    <meta property="og:description" content="{% block og_description %}A bio-acoustic instrument for generative composition{% endblock og_description %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ current_url | default(value=config.base_url) }}">
    <meta property="og:image" content="{{ get_url(path='screenshot1.png') }}">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}{{ config.title }}{% endblock twitter_title %}">
    <meta name="twitter:description" content="{% block twitter_description %}A bio-acoustic instrument for generative composition{% endblock twitter_description %}">
    <meta name="twitter:image" content="{{ get_url(path='screenshot1.png') }}">

    <!-- Canonical -->
    <link rel="canonical" href="{{ current_url | default(value=config.base_url) }}">

    {% block head %}{% endblock head %}
</head>
<body class="{% block body_class %}{% endblock body_class %}">
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <a href="{% if lang == 'ja' %}/ja{% else %}/{% endif %}" class="nav-brand">
                    {{ config.title }}
                </a>

                <button class="nav-toggle" type="button" aria-controls="site-nav" aria-expanded="false">
                    Menu
                </button>

                <div class="nav-menu" id="site-nav">
                    <a href="{% if lang == 'ja' %}/ja{% else %}/{% endif %}" class="nav-link">
                        Home
                    </a>
                    <a href="{% if lang == 'ja' %}/ja/manifesto{% else %}/manifesto{% endif %}" class="nav-link">
                        Manifesto
                    </a>
                    <a href="/technote" class="nav-link">
                        Technote
                    </a>
                    <a href="{% if lang == 'ja' %}/ja/docs{% else %}/docs{% endif %}" class="nav-link">
                        Documentation
                    </a>
                    <a href="{{ config.extra.github_url }}" class="nav-link" target="_blank" rel="noopener">
                        GitHub
                    </a>
                    <a href="{{ config.extra.x_url }}" class="nav-link" target="_blank" rel="noopener">
                        X
                    </a>

                    <!-- Language switcher -->
                    <div class="lang-switcher">
                        {% if lang == "ja" %}
                            {% if page %}
                                <a href="{{ page.permalink | replace(from='/ja/', to='/') | replace(from='/ja', to='/') }}" class="lang-link">EN</a>
                            {% else %}
                                <a href="/" class="lang-link">EN</a>
                            {% endif %}
                        {% else %}
                            {% if page %}
                                <a href="/ja{{ page.permalink | replace(from=config.base_url, to='') }}" class="lang-link">日本語</a>
                            {% else %}
                                <a href="/ja" class="lang-link">日本語</a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="main">
        {% block content %}{% endblock content %}
    </main>

    <footer class="footer">
        <div class="footer-container">
            <p>
                &copy; {{ now() | date(format="%Y") }} {{ config.author }}.
                {% if lang == "ja" %}
                    ソースコードは <a href="{{ config.extra.github_url }}" target="_blank" rel="noopener">GitHub</a> で公開されています。
                {% else %}
                    Source code available on <a href="{{ config.extra.github_url }}" target="_blank" rel="noopener">GitHub</a>.
                {% endif %}
            </p>
        </div>
    </footer>

    {% block scripts %}{% endblock scripts %}
    <script>
        (function () {
            var toggle = document.querySelector('.nav-toggle');
            var menu = document.querySelector('#site-nav');
            if (!toggle || !menu) {
                return;
            }
            toggle.addEventListener('click', function () {
                var isOpen = menu.classList.toggle('is-open');
                toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
            });
        })();
    </script>
</body>
</html>
